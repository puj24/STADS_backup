#include "cortos.h"
// #include "test.h"
#include "../../testcases/SIS_run_13/SIS_iter_1.h"
#include "../../testcases/SIS_run_13/SIS_iter_2.h"
#include "../../testcases/SIS_run_13/SIS_iter_3.h"
#include "../../testcases/SIS_run_13/SIS_iter_4.h"
#include "../../testcases/SIS_run_13/SIS_iter_5.h"
#include "../../testcases/SIS_run_13/SIS_iter_6.h"
#include "../../testcases/SIS_run_13/SIS_iter_7.h"
#include "../../testcases/SIS_run_13/SIS_iter_8.h"
#include "../../testcases/SIS_run_13/SIS_iter_9.h"
#include "../../testcases/SIS_run_13/SIS_iter_10.h"
#include "../../testcases/SIS_run_13/SIS_iter_11.h"
#include "../../testcases/SIS_run_13/SIS_iter_12.h"
#include "../../testcases/SIS_run_13/SIS_iter_13.h"
#include "../../testcases/SIS_run_13/SIS_iter_14.h"
#include "../../testcases/SIS_run_13/SIS_iter_15.h"
#include "../../testcases/SIS_run_13/SIS_iter_16.h"
#include "../../testcases/SIS_run_13/SIS_iter_17.h"
#include "../../testcases/SIS_run_13/SIS_iter_18.h"
#include "../../testcases/SIS_run_13/SIS_iter_19.h"
#include "../../testcases/SIS_run_13/SIS_iter_20.h"
#include "../../testcases/SIS_run_13/SIS_iter_21.h"
#include "../../testcases/SIS_run_13/SIS_iter_22.h"
#include "../../testcases/SIS_run_13/SIS_iter_23.h"
#include "../../testcases/SIS_run_13/SIS_iter_24.h"
#include "../../testcases/SIS_run_13/SIS_iter_25.h"
#include "../../testcases/SIS_run_13/SIS_iter_26.h"
#include "../../testcases/SIS_run_13/SIS_iter_27.h"
#include "../../testcases/SIS_run_13/SIS_iter_28.h"
#include "../../testcases/SIS_run_13/SIS_iter_29.h"
#include "../../testcases/SIS_run_13/SIS_iter_30.h"
#include "../../testcases/SIS_run_13/SIS_iter_31.h"
#include "../../testcases/SIS_run_13/SIS_iter_32.h"
#include "../../testcases/SIS_run_13/SIS_iter_33.h"
#include "../../testcases/SIS_run_13/SIS_iter_34.h"
#include "../../testcases/SIS_run_13/SIS_iter_35.h"
#include "../../testcases/SIS_run_13/SIS_iter_36.h"
#include "../../testcases/SIS_run_13/SIS_iter_37.h"
#include "../../testcases/SIS_run_13/SIS_iter_38.h"
#include "../../testcases/SIS_run_13/SIS_iter_39.h"
#include "../../testcases/SIS_run_13/SIS_iter_40.h"
#include "../../testcases/SIS_run_13/SIS_iter_41.h"
#include "../../testcases/SIS_run_13/SIS_iter_42.h"
#include "../../testcases/SIS_run_13/SIS_iter_43.h"
#include "../../testcases/SIS_run_13/SIS_iter_44.h"
#include "../../testcases/SIS_run_13/SIS_iter_45.h"
#include "../../testcases/SIS_run_13/SIS_iter_46.h"
#include "../../testcases/SIS_run_13/SIS_iter_47.h"
#include "../../testcases/SIS_run_13/SIS_iter_48.h"
#include "../../testcases/SIS_run_13/SIS_iter_49.h"
#include "../../testcases/SIS_run_13/SIS_iter_50.h"
#include "../../testcases/SIS_run_13/SIS_iter_51.h"
#include "../../testcases/SIS_run_13/SIS_iter_52.h"
#include "../../testcases/SIS_run_13/SIS_iter_53.h"
#include "../../testcases/SIS_run_13/SIS_iter_54.h"
#include "../../testcases/SIS_run_13/SIS_iter_55.h"
#include "../../testcases/SIS_run_13/SIS_iter_56.h"
#include "../../testcases/SIS_run_13/SIS_iter_57.h"
#include "../../testcases/SIS_run_13/SIS_iter_58.h"
#include "../../testcases/SIS_run_13/SIS_iter_59.h"
#include "../../testcases/SIS_run_13/SIS_iter_60.h"
#include "../../testcases/SIS_run_13/SIS_iter_61.h"
#include "../../testcases/SIS_run_13/SIS_iter_62.h"
#include "../../testcases/SIS_run_13/SIS_iter_63.h"
#include "../../testcases/SIS_run_13/SIS_iter_64.h"
#include "../../testcases/SIS_run_13/SIS_iter_65.h"
#include "../../testcases/SIS_run_13/SIS_iter_66.h"
#include "../../testcases/SIS_run_13/SIS_iter_67.h"
#include "../../testcases/SIS_run_13/SIS_iter_68.h"
#include "../../testcases/SIS_run_13/SIS_iter_69.h"
#include "../../testcases/SIS_run_13/SIS_iter_70.h"
#include "../../testcases/SIS_run_13/SIS_iter_71.h"
#include "../../testcases/SIS_run_13/SIS_iter_72.h"
#include "../../testcases/SIS_run_13/SIS_iter_73.h"
#include "../../testcases/SIS_run_13/SIS_iter_74.h"
#include "../../testcases/SIS_run_13/SIS_iter_75.h"
#include "../../testcases/SIS_run_13/SIS_iter_76.h"
#include "../../testcases/SIS_run_13/SIS_iter_77.h"
#include "../../testcases/SIS_run_13/SIS_iter_78.h"
#include "../../testcases/SIS_run_13/SIS_iter_79.h"
#include "../../testcases/SIS_run_13/SIS_iter_80.h"
#include "../../testcases/SIS_run_13/SIS_iter_81.h"
#include "../../testcases/SIS_run_13/SIS_iter_82.h"
#include "../../testcases/SIS_run_13/SIS_iter_83.h"
#include "../../testcases/SIS_run_13/SIS_iter_84.h"
#include "../../testcases/SIS_run_13/SIS_iter_85.h"
#include "../../testcases/SIS_run_13/SIS_iter_86.h"
#include "../../testcases/SIS_run_13/SIS_iter_87.h"
#include "../../testcases/SIS_run_13/SIS_iter_88.h"
#include "../../testcases/SIS_run_13/SIS_iter_89.h"
#include "../../testcases/SIS_run_13/SIS_iter_90.h"
#include "../../testcases/SIS_run_13/SIS_iter_91.h"
#include "../../testcases/SIS_run_13/SIS_iter_92.h"
#include "../../testcases/SIS_run_13/SIS_iter_93.h"
#include "../../testcases/SIS_run_13/SIS_iter_94.h"
#include "../../testcases/SIS_run_13/SIS_iter_95.h"
#include "../../testcases/SIS_run_13/SIS_iter_96.h"
#include "../../testcases/SIS_run_13/SIS_iter_97.h"
#include "../../testcases/SIS_run_13/SIS_iter_98.h"
#include "../../testcases/SIS_run_13/SIS_iter_99.h"
#include "../../testcases/SIS_run_13/SIS_iter_100.h"


//combined structures.c into quest.c --------
typedef struct Vec Vec;//stores three components of vector x, y, z;
typedef struct Matrix_3 Matrix_3;//creates a variable to store 3 by 3 matrix;
double absoluteValue(double x);
double square_root(double x);
void Vec_construct(Vec *temp, double x,double y,double z); // Construct a vector
void cross(Vec* temp,Vec* vec1,Vec* vec2); // Takes cross product : vec1 * vec2 and stores it in temp
double dot(Vec* vec1,Vec* vec2); // Takes the dot product
void scale_vec(Vec *temp,double k); // Scales a vector by a scalar (modifies the input)
void add_vec(Vec *temp,Vec* vec1,Vec* vec2); //Adds 2 vectors and stores in temp
void matrix_construct(Matrix_3 *temp,unsigned char x); // Based on x, Matrix is constructed - can be a zero matrix or an identity matrix
void add_matrix(Matrix_3 *temp,Matrix_3 *m1,Matrix_3 *m2);
void scale_matrix(Matrix_3 *temp,Matrix_3 *M,double k); // scales a matrix by a scalar (modifies the input matrix)
double det(Matrix_3 *temp); // takes the determinant of the matrix
double trace(Matrix_3 *temp);
void T(Matrix_3 *temp,Matrix_3 *m1); // Takes the transpose of m and stores in temp
void adjoint(Matrix_3 *temp,Matrix_3* m); // adjoint of m is stored in temp
void outer_product(Matrix_3* temp,Vec* v1,Vec* v2); // v1 v2^T = temp (Outer product in this order)
void matmul(Vec* temp,Matrix_3* M,Vec *v); // temp = Mv (Matrix and vector multiplication in this order)



struct Vec{
        double x,y,z;
};

double absoluteValue(double x){
    if(x<0){
    x =-x;}
    return x;

}

double square_root(double x){
    double guess =1;
    while (absoluteValue((guess*guess)/x -1.0) >= 0.00001){
        guess = ((x/guess) + guess)/2;

    }
  return guess;
} //square_root fuction ---------
void Vec_construct(Vec *temp, double x,double y,double z)
{
        temp->x = x;
        temp->y = y;
        temp->z = z;
}
void cross(Vec* temp,Vec* vec1,Vec* vec2){
        temp->x = vec1->y*vec2->z - vec1->z*vec2->y;
        temp->y = vec1->z*vec2->x - vec1->x*vec2->z;
        temp->z = vec1->x*vec2->y - vec1->y*vec2->x;
}
double dot(Vec* vec1,Vec* vec2){
        return (vec1->x*vec2->x + vec1->y*vec2->y + vec1->z*vec2->z);
}
void scale_vec(Vec *temp,double k){  // This modifies the input matrix
        temp->x *= k;temp->y *= k;temp->z *= k;
}
void add_vec(Vec *temp,Vec* vec1,Vec* vec2){
        temp->x = vec1->x + vec2->x;
        temp->y = vec1->y + vec2->y;
        temp->z = vec1->z + vec2->z;
}
struct Matrix_3{
        double elements[3][3];
        // Vec operator* (Vec v);
};

void matrix_construct(Matrix_3 *temp,unsigned char x)
{
        if (x == 0){ // Null Matrix
        unsigned char i = 0;
        unsigned char j = 0;
                for (i=0; i < 3; i++) {
                        for (j = 0; j < 3; j++) {
                                (temp->elements)[i][j] = 0;
                        }
                }
        }
        if (x == 1){  // Identity Matrix
        unsigned char i = 0;
        unsigned char j = 0;
                for ( i = 0; i < 3; i++) {
                        for (j = 0; j < 3; j++) {
                                if (i == j) (temp->elements)[i][j] = 1;
                                else (temp->elements)[i][j] = 0;
                        }
                }
        }
}
void add_matrix(Matrix_3 *temp,Matrix_3 *m1,Matrix_3 *m2){
        unsigned char i = 0;
        unsigned char j = 0;
        for ( i = 0; i < 3; i++) {
                for ( j = 0; j < 3; j++) {
                        (temp->elements)[i][j] = (m1->elements)[i][j] + (m2->elements)[i][j];
                }
        }
}

void scale_matrix(Matrix_3 *temp,Matrix_3 *M,double k){
        unsigned char i = 0;
        unsigned char j = 0;
        for ( i = 0; i < 3; i++) {
                for ( j = 0; j < 3; j++) {
                        temp->elements[i][j] = (M->elements[i][j])*k;
                }
        }
}
double det(Matrix_3 *temp){
        double x;
        x = temp->elements[0][0] * (temp->elements[1][1]*temp->elements[2][2] - temp->elements[1][2]*temp->elements[2][1])
        - temp->elements[0][1] * (temp->elements[1][0]*temp->elements[2][2] - temp->elements[1][2]*temp->elements[2][0])
        + temp->elements[0][2] * (temp->elements[1][0]*temp->elements[2][1] - temp->elements[1][1]*temp->elements[2][0]);
        return x;
}
double trace(Matrix_3 *temp){
        return (temp->elements[0][0] + temp->elements[1][1] + temp->elements[2][2]);
}
void T(Matrix_3 *temp,Matrix_3 *m1){
         unsigned char i = 0;
         unsigned char j = 0;                                                           // Transpose Operation
        for (i = 0; i < 3; i++) {
                for (j = 0; j < 3; j++) {
                        temp->elements[i][j] = m1->elements[j][i];
                }
        }        // #REVISIT pass value by reference
}
void adjoint(Matrix_3 *temp,Matrix_3* m){
        temp->elements[0][0] = m->elements[1][1]*m->elements[2][2] - m->elements[1][2]*m->elements[2][1];
        temp->elements[1][0] = m->elements[1][2]*m->elements[2][0] - m->elements[1][0]*m->elements[2][2];
        temp->elements[2][0] = m->elements[1][0]*m->elements[2][1] - m->elements[2][0]*m->elements[1][1];
        temp->elements[0][1] = m->elements[2][1]*m->elements[0][2] - m->elements[0][1]*m->elements[2][2];
        temp->elements[1][1] = m->elements[0][0]*m->elements[2][2] - m->elements[2][0]*m->elements[0][2];
        temp->elements[2][1] = m->elements[2][0]*m->elements[0][1] - m->elements[0][0]*m->elements[2][1];
        temp->elements[0][2] = m->elements[0][1]*m->elements[1][2] - m->elements[1][1]*m->elements[0][2];
        temp->elements[1][2] = m->elements[1][0]*m->elements[0][2] - m->elements[0][0]*m->elements[1][2];
        temp->elements[2][2] = m->elements[0][0]*m->elements[1][1] - m->elements[1][0]*m->elements[0][1];
}
void outer_product(Matrix_3* temp,Vec* v1,Vec* v2){
        temp->elements[0][0] = v1->x*v2->x;
        temp->elements[0][1] = v1->x*v2->y;
        temp->elements[0][2] = v1->x*v2->z;
        temp->elements[1][0] = v1->y*v2->x;
        temp->elements[1][1] = v1->y*v2->y;
        temp->elements[1][2] = v1->y*v2->z;
        temp->elements[2][0] = v1->z*v2->x;
        temp->elements[2][1] = v1->z*v2->y;
        temp->elements[2][2] = v1->z*v2->z;
}
void matmul(Vec* temp,Matrix_3* M,Vec *v){
        temp->x = M->elements[0][0]*v->x + M->elements[0][1]*v->y + M->elements[0][2]*v->z;
        temp->y = M->elements[1][0]*v->x + M->elements[1][1]*v->y + M->elements[1][2]*v->z;
        temp->z = M->elements[2][0]*v->x + M->elements[2][1]*v->y + M->elements[2][2]*v->z;
}

//unsigned char S = 8;
/*double data[3][8]= {{0.957722651640405,0.976714746919261,0.961622210693582,0.961619350367632,0.999406527435311,0.998606971625915,0.999000101390675,0.998791708377844},
{0.199312576137403,0.121371462238701,0.151933361348517,0.147675461166639,0.0240680200543449,-0.0478769462622676,-0.0266751213956533,-0.031370687440537},
{0.20746522486514,0.17691034821198,0.228470955725512,0.231257828338314,0.0246439309030866,-0.0221791396748953,0.0358780618198374,0.037828603531934
}};*/ //input array ----------





void quest(double Q[4], int nos,double data[3][2*nos],unsigned char N) // Based upon the input data, this function prints the components of the estimated quaternion//nos is number of stars
{
        uint64_t t1 = cortos_get_clock_time();
        //int number_of_stars = 4;
        //unsigned char N = 2;
        Vec b[N];Vec r[N];

        double epsilon = 0.001; // epsilon is the threshold error which when exceeded would require rotation

        double a[N]; // weight vector
        //a[0] = 1.0/N;a[1] = 1.0/N;a[2] = 1.0/N;a[3] = 1.0/N;a[4] = 1.0/N;
        int c;
        for(c = 0;c < N;c++){
                a[c] = 0;
                a[c] = 1.0/N;}
        double guess = 1; // initial guess
        Matrix_3 B,S;
        matrix_construct(&B,0); // Constructs a 3*3 Matrix with all zeroes
        matrix_construct(&S,0);
        Vec z;
        Vec_construct(&z,0,0,0); // Constructs a 3*1 vector with all zeroes
        unsigned char counter = 0; // counter used in the do while loop below
        double K;
        double norm_2_z;
        double det_S;
        double trace_B;
        double zTSz;
        double zTSSz;
        Matrix_3 adj_S;
        Matrix_3 check;
        // We have the csv file stored in **data
        int i =0;
        //int nos = 4;//nos is number of stars*2
        for( i = 0;i < nos*2;i++){ // i is the column number
                if(i < nos){
                        Vec_construct(&r[i],data[0][i],data[1][i],data[2][i]); // Construct r vectors according to the data read
                }
                else{
                        Vec_construct(&b[i-nos],data[0][i],data[1][i],data[2][i]); // Construct b vectors according to the data read
                }
        }


        // Perform Quest
        double f(double x){ // This is the function whose roots are found using Newton Rapshon
                double first = (x*x - trace_B*trace_B + K)*(x*x - trace_B*trace_B - norm_2_z);
                double second = (x - trace_B)*(zTSz + det_S);
                return (first - second - zTSSz);
        }
        double f_bar(double x){//This is the derivative of the function whose roots are found using Newton Rapshon
                double temp = 2*x*(2*x*x - 2*trace_B*trace_B + K - norm_2_z);
                return (temp - zTSz - det_S);
        }

        do {
                if(counter == 1){ // Perform rotation abt x --- {x,-y,-z}
                        //unsigned char i = 0;
                        for (i = 0; i < N; i++){
                                r[i].y = -1*r[i].y;
                                r[i].z = -1*r[i].z;
                        }
                        }
                if(counter == 2){ // Perform rotation abt y --- {-x,y,-z}
                //unsigned char i = 0;
                for ( i = 0; i < N; i++){
                        r[i].x = -1*r[i].x;
                        r[i].z = -1*r[i].z;
                }
                }
                if(counter == 3){ // Perform rotation abt z --- {-x,-y,z}
                //unsigned char i = 0;
                for ( i = 0; i < N; i++){
                        r[i].y = -1*r[i].y;
                        r[i].x = -1*r[i].x;
                }
                }
        //unsigned char i = 0;
                for (i = 0; i < N; i++){
                        Matrix_3 temp;
                        outer_product(&temp,&(b[i]),&(r[i]));
                        scale_matrix(&temp,&temp,a[i]);
                        add_matrix(&B,&B,&temp);
                }
                for (i = 0; i < N; i++)
                {
                        Vec temp;
                        cross(&temp,&(b[i]),&(r[i]));
                        scale_vec(&temp,a[i]);
                        add_vec(&z,&z,&temp);
                }

                trace_B = trace(&B);
                T(&S,&B); // Takes the Transponse of a matrix
                add_matrix(&S,&S,&B); // construct S
                adjoint(&adj_S,&S); // Takes the adjoint of a matrix
                K = trace(&adj_S);
                norm_2_z = z.x*z.x + z.y*z.y + z.z*z.z;
                det_S = det(&S); // Takes the determinant of a matrix
                Vec temp1,temp2; // temporary variables
                matmul(&temp1,&S,&z);
                zTSz = dot(&z,&temp1);
                matmul(&temp2,&S,&temp1);
                zTSSz = dot(&z,&temp2);

                double rho = guess; // sum of weights
                for ( i = 0; i < 10; i++) {
                        double x1 = f(rho);
                        double x2 = f_bar(rho);
                        rho =rho - x1/x2;
                }
                rho += trace_B;
                Matrix_3 I;
                matrix_construct(&I,1);
                scale_matrix(&I,&I,rho);
                scale_matrix(&check,&S,-1);
                add_matrix(&check,&check,&I);

                counter++;
                } while((det(&check)) < epsilon);

        Vec q_3;
        double q_4 = det(&check);
        Matrix_3 adj_check;
        adjoint(&adj_check,&check);
        matmul(&q_3,&adj_check,&z); //  (I3*rho - (B + B.T())).adjoint() * z

        if(counter == 2){
                Vec e;
                Vec_construct(&e,1,0,0);
                double new_4 = -dot(&e,&q_3);
                cross(&q_3,&e,&q_3);
                scale_vec(&e,q_4);
                add_vec(&q_3,&q_3,&e);
                q_4 = new_4;
        }
        else if(counter == 3){
                Vec e;
                Vec_construct(&e,0,1,0);
                double new_4 = -dot(&e,&q_3);
                cross(&q_3,&e,&q_3);
                scale_vec(&e,q_4);
        add_vec(&q_3,&q_3,&e);
                q_4 = new_4;
        }
        else if(counter == 4){
                Vec e;
                Vec_construct(&e,0,0,1);
                double new_4 = -dot(&e,&q_3);
                cross(&q_3,&e,&q_3);
                scale_vec(&e,q_4);
                add_vec(&q_3,&q_3,&e);
                q_4 = new_4;
        }
        double alpha;
        //double a1 =  (100*q_3.x)*(100*q_3.x);
        //double a2 = (100*q_3.y)*(100*q_3.y);
        //double a3 = (100*q_3.z)*(100*q_3.z);
        //double a4 = (100*q_4)*(100*q_4);
        //alpha = square_root(a1+a2+a3+a4);

        double x1 =(q_3.x);
        double x2 = (q_3.y);
        double x3 = (q_3.z);
        double x4 = (q_4);
        //double x;
        //double y = 100;
        //x = sqrt(y);
        //CORTOS_INFO("root(x) = %.9lf",x);
        alpha = square_root(x1*x1 + x2*x2+ x3*x3+ x4*x4);
        //CORTOS_INFO("q_3.x = %lf",x1/alpha);
        //CORTOS_INFO("q_3.y = %lf",x2/alpha);
        //CORTOS_INFO("q_3.z = %lf",x3/alpha);
        //CORTOS_INFO("q_4 = %lf",x4/alpha);
        //CORTOS_INFO("alpha = %lf",alpha);
        Q[0] = x1/alpha;
        Q[1] = x2/alpha;
        Q[2] = x3/alpha;
        Q[3] = x4/alpha;

        uint64_t t2 = cortos_get_clock_time();
	uint32_t t11 = t1 & (0xffffffff);
	uint32_t t12 = t2 & (0xffffffff);

        cortos_printf("q_3.x = %.15f\n", Q[0]);
        cortos_printf("q_3.y = %.15f\n", Q[1]);
        cortos_printf("q_3.z = %.15f\n", Q[2]);
        cortos_printf("q_4   = %.15f\n", Q[3]);

        cortos_printf("time_ =  %u\n",t12-t11);

        return ;
}

// --------------------------------------------------------- READING THE CSV FILE -------------------------------------------
/*void read_csv(int row, int col, char *filename, double **data){
        FILE *file;
        file = fopen(filename, "r");

        int i = 0;

    char line[4098];
        while (fgets(line, 4098, file) && (i < row))
    {
        char* tmp = strdup(line); // This duplicates the string

            int j = 0;
            const char* tok;
            for (tok = strtok(line, ","); tok && *tok; j++, tok = strtok(NULL, ","))
            {
                data[i][j] = atof(tok); // This stores the data in data
            }
        free(tmp);
        i++;
    }
}*/ //read_csv no longer needed ---------
// ------------------------------------------------------------------------------
void main()
{
        double out[4];
	//long int t0=ajit_barebones_clock();
        cortos_printf("\nSIS_iter_1\n");
        quest(&out,nos_1,data_1,N_1);

        cortos_printf("\nSIS_iter_2\n");
        quest(&out,nos_2,data_2,N_2);

        cortos_printf("\nSIS_iter_3\n");
        quest(&out,nos_3,data_3,N_3);

        cortos_printf("\nSIS_iter_4\n");
        quest(&out,nos_4,data_4,N_4);

        cortos_printf("\nSIS_iter_5\n");
        quest(&out,nos_5,data_5,N_5);

        cortos_printf("\nSIS_iter_6\n");
        quest(&out,nos_6,data_6,N_6);

        cortos_printf("\nSIS_iter_7\n");
        quest(&out,nos_7,data_7,N_7);

        cortos_printf("\nSIS_iter_8\n");
        quest(&out,nos_8,data_8,N_8);

        cortos_printf("\nSIS_iter_9\n");
        quest(&out,nos_9,data_9,N_9);

        cortos_printf("\nSIS_iter_10\n");
        quest(&out,nos_10,data_10,N_10);

        cortos_printf("\nSIS_iter_11\n");
        quest(&out,nos_11,data_11,N_11);

        cortos_printf("\nSIS_iter_12\n");
        quest(&out,nos_12,data_12,N_12);

        cortos_printf("\nSIS_iter_13\n");
        quest(&out,nos_13,data_13,N_13);

        cortos_printf("\nSIS_iter_14\n");
        quest(&out,nos_14,data_14,N_14);

        cortos_printf("\nSIS_iter_15\n");
        quest(&out,nos_15,data_15,N_15);

        cortos_printf("\nSIS_iter_16\n");
        quest(&out,nos_16,data_16,N_16);

        cortos_printf("\nSIS_iter_17\n");
        quest(&out,nos_17,data_17,N_17);

        cortos_printf("\nSIS_iter_18\n");
        quest(&out,nos_18,data_18,N_18);

        cortos_printf("\nSIS_iter_19\n");
        quest(&out,nos_19,data_19,N_19);

        cortos_printf("\nSIS_iter_20\n");
        quest(&out,nos_20,data_20,N_20);

        cortos_printf("\nSIS_iter_21\n");
        quest(&out,nos_21,data_21,N_21);

        cortos_printf("\nSIS_iter_22\n");
        quest(&out,nos_22,data_22,N_22);

        cortos_printf("\nSIS_iter_23\n");
        quest(&out,nos_23,data_23,N_23);

        cortos_printf("\nSIS_iter_24\n");
        quest(&out,nos_24,data_24,N_24);

        cortos_printf("\nSIS_iter_25\n");
        quest(&out,nos_25,data_25,N_25);

        cortos_printf("\nSIS_iter_26\n");
        quest(&out,nos_26,data_26,N_26);

        cortos_printf("\nSIS_iter_27\n");
        quest(&out,nos_27,data_27,N_27);

        cortos_printf("\nSIS_iter_28\n");
        quest(&out,nos_28,data_28,N_28);

        cortos_printf("\nSIS_iter_29\n");
        quest(&out,nos_29,data_29,N_29);

        cortos_printf("\nSIS_iter_30\n");
        quest(&out,nos_30,data_30,N_30);

        cortos_printf("\nSIS_iter_31\n");
        quest(&out,nos_31,data_31,N_31);

        cortos_printf("\nSIS_iter_32\n");
        quest(&out,nos_32,data_32,N_32);

        cortos_printf("\nSIS_iter_33\n");
        quest(&out,nos_33,data_33,N_33);

        cortos_printf("\nSIS_iter_34\n");
        quest(&out,nos_34,data_34,N_34);

        cortos_printf("\nSIS_iter_35\n");
        quest(&out,nos_35,data_35,N_35);

        cortos_printf("\nSIS_iter_36\n");
        quest(&out,nos_36,data_36,N_36);

        cortos_printf("\nSIS_iter_37\n");
        quest(&out,nos_37,data_37,N_37);

        cortos_printf("\nSIS_iter_38\n");
        quest(&out,nos_38,data_38,N_38);

        cortos_printf("\nSIS_iter_39\n");
        quest(&out,nos_39,data_39,N_39);

        cortos_printf("\nSIS_iter_40\n");
        quest(&out,nos_40,data_40,N_40);

        cortos_printf("\nSIS_iter_41\n");
        quest(&out,nos_41,data_41,N_41);

        cortos_printf("\nSIS_iter_42\n");
        quest(&out,nos_42,data_42,N_42);

        cortos_printf("\nSIS_iter_43\n");
        quest(&out,nos_43,data_43,N_43);

        cortos_printf("\nSIS_iter_44\n");
        quest(&out,nos_44,data_44,N_44);

        cortos_printf("\nSIS_iter_45\n");
        quest(&out,nos_45,data_45,N_45);

        cortos_printf("\nSIS_iter_46\n");
        quest(&out,nos_46,data_46,N_46);

        cortos_printf("\nSIS_iter_47\n");
        quest(&out,nos_47,data_47,N_47);

        cortos_printf("\nSIS_iter_48\n");
        quest(&out,nos_48,data_48,N_48);

        cortos_printf("\nSIS_iter_49\n");
        quest(&out,nos_49,data_49,N_49);

        cortos_printf("\nSIS_iter_50\n");
        quest(&out,nos_50,data_50,N_50);

        cortos_printf("\nSIS_iter_51\n");
        quest(&out,nos_51,data_51,N_51);

        cortos_printf("\nSIS_iter_52\n");
        quest(&out,nos_52,data_52,N_52);

        cortos_printf("\nSIS_iter_53\n");
        quest(&out,nos_53,data_53,N_53);

        cortos_printf("\nSIS_iter_54\n");
        quest(&out,nos_54,data_54,N_54);

        cortos_printf("\nSIS_iter_55\n");
        quest(&out,nos_55,data_55,N_55);

        cortos_printf("\nSIS_iter_56\n");
        quest(&out,nos_56,data_56,N_56);

        cortos_printf("\nSIS_iter_57\n");
        quest(&out,nos_57,data_57,N_57);

        cortos_printf("\nSIS_iter_58\n");
        quest(&out,nos_58,data_58,N_58);

        cortos_printf("\nSIS_iter_59\n");
        quest(&out,nos_59,data_59,N_59);

        cortos_printf("\nSIS_iter_60\n");
        quest(&out,nos_60,data_60,N_60);

        cortos_printf("\nSIS_iter_61\n");
        quest(&out,nos_61,data_61,N_61);

        cortos_printf("\nSIS_iter_62\n");
        quest(&out,nos_62,data_62,N_62);

        cortos_printf("\nSIS_iter_63\n");
        quest(&out,nos_63,data_63,N_63);

        cortos_printf("\nSIS_iter_64\n");
        quest(&out,nos_64,data_64,N_64);

        cortos_printf("\nSIS_iter_65\n");
        quest(&out,nos_65,data_65,N_65);

        cortos_printf("\nSIS_iter_66\n");
        quest(&out,nos_66,data_66,N_66);

        cortos_printf("\nSIS_iter_67\n");
        quest(&out,nos_67,data_67,N_67);

        cortos_printf("\nSIS_iter_68\n");
        quest(&out,nos_68,data_68,N_68);

        cortos_printf("\nSIS_iter_69\n");
        quest(&out,nos_69,data_69,N_69);

        cortos_printf("\nSIS_iter_70\n");
        quest(&out,nos_70,data_70,N_70);

        cortos_printf("\nSIS_iter_71\n");
        quest(&out,nos_71,data_71,N_71);

        cortos_printf("\nSIS_iter_72\n");
        quest(&out,nos_72,data_72,N_72);

        cortos_printf("\nSIS_iter_73\n");
        quest(&out,nos_73,data_73,N_73);

        cortos_printf("\nSIS_iter_74\n");
        quest(&out,nos_74,data_74,N_74);

        cortos_printf("\nSIS_iter_75\n");
        quest(&out,nos_75,data_75,N_75);

        cortos_printf("\nSIS_iter_76\n");
        quest(&out,nos_76,data_76,N_76);

        cortos_printf("\nSIS_iter_77\n");
        quest(&out,nos_77,data_77,N_77);

        cortos_printf("\nSIS_iter_78\n");
        quest(&out,nos_78,data_78,N_78);

        cortos_printf("\nSIS_iter_79\n");
        quest(&out,nos_79,data_79,N_79);

        cortos_printf("\nSIS_iter_80\n");
        quest(&out,nos_80,data_80,N_80);

        cortos_printf("\nSIS_iter_81\n");
        quest(&out,nos_81,data_81,N_81);

        cortos_printf("\nSIS_iter_82\n");
        quest(&out,nos_82,data_82,N_82);

        cortos_printf("\nSIS_iter_83\n");
        quest(&out,nos_83,data_83,N_83);

        cortos_printf("\nSIS_iter_84\n");
        quest(&out,nos_84,data_84,N_84);

        cortos_printf("\nSIS_iter_85\n");
        quest(&out,nos_85,data_85,N_85);

        cortos_printf("\nSIS_iter_86\n");
        quest(&out,nos_86,data_86,N_86);

        cortos_printf("\nSIS_iter_87\n");
        quest(&out,nos_87,data_87,N_87);

        cortos_printf("\nSIS_iter_88\n");
        quest(&out,nos_88,data_88,N_88);

        cortos_printf("\nSIS_iter_89\n");
        quest(&out,nos_89,data_89,N_89);

        cortos_printf("\nSIS_iter_90\n");
        quest(&out,nos_90,data_90,N_90);

        cortos_printf("\nSIS_iter_91\n");
        quest(&out,nos_91,data_91,N_91);

        cortos_printf("\nSIS_iter_92\n");
        quest(&out,nos_92,data_92,N_92);

        cortos_printf("\nSIS_iter_93\n");
        quest(&out,nos_93,data_93,N_93);

        cortos_printf("\nSIS_iter_94\n");
        quest(&out,nos_94,data_94,N_94);

        cortos_printf("\nSIS_iter_95\n");
        quest(&out,nos_95,data_95,N_95);

        cortos_printf("\nSIS_iter_96\n");
        quest(&out,nos_96,data_96,N_96);

        cortos_printf("\nSIS_iter_97\n");
        quest(&out,nos_97,data_97,N_97);

        cortos_printf("\nSIS_iter_98\n");
        quest(&out,nos_98,data_98,N_98);

        cortos_printf("\nSIS_iter_99\n");
        quest(&out,nos_99,data_99,N_99);

        cortos_printf("\nSIS_iter_100\n");
        quest(&out,nos_100,data_100,N_100);
        cortos_exit(0);
}
